# Stats String Field-by-Field Comparison

This document compares the original stats string from the save file (`spl[4]`) with the re-serialized string (`stats_str_new`) to identify the source of the mismatch.

## Field Count Analysis

- **Original `spl[4]` field count:** 55
- **Python-generated `stats_list` field count:** 55


## Detailed Field Comparison

| Index | JS Variable (`main.js`) | Python Key (`parser.py`) | Original Value (`spl[4]`) | Serialized Value (`stats_str_new`) | Match? |
|---|---|---|---|---|---|
| 0 | `Game.cookies` | `cookies` | `12401719440.323624` | `12401719440.323624` | Yes |
| 1 | `Game.cookiesEarned` | `cookies_earned` | `16716604460.189524` | `16716604460.189524` | Yes |
| 2 | `Game.cookieClicks` | `cookie_clicks` | `12425` | `12425` | Yes |
| 3 | `Game.goldenClicks` | `golden_clicks` | `9` | `9` | Yes |
| 4 | `Game.handmadeCookies` | `handmade_cookies` | `65391637.07692009` | `65391637.07692009` | Yes |
| 5 | `Game.missedGoldenClicks` | `missed_golden_clicks` | `99` | `99` | Yes |
| 6 | `Game.bgType` | `bg_type` | `0` | `0` | Yes |
| 7 | `Game.milkType` | `milk_type` | `0` | `0` | Yes |
| 8 | `Game.cookiesReset` | `cookies_reset` | `0` | `0` | Yes |
| 9 | `Game.elderWrath` | `elder_wrath` | `0` | `0` | Yes |
| 10 | `Game.pledges` | `pledges` | `0` | `0` | Yes |
| 11 | `Game.pledgeT` | `pledge_t` | `0` | `0` | Yes |
| 12 | `Game.nextResearch` | `next_research` | `0` | `0` | Yes |
| 13 | `Game.researchT` | `research_t` | `0` | `0` | Yes |
| 14 | `Game.resets` | `resets` | `0` | `0` | Yes |
| 15 | `Game.goldenClicksLocal` | `golden_clicks_local` | `9` | `9` | Yes |
| 16 | `Game.cookiesSucked` | `cookies_sucked` | `0` | `0` | Yes |
| 17 | `Game.wrinklersPopped` | `wrinklers_popped` | `0` | `0` | Yes |
| 18 | `Game.santaLevel` | `santa_level` | `0` | `0` | Yes |
| 19 | `Game.reindeerClicked` | `reindeer_clicked` | `0` | `0` | Yes |
| 20 | `Game.seasonT` | `season_t` | `0` | `0` | Yes |
| 21 | `Game.seasonUses` | `season_uses` | `0` | `0` | Yes |
| 22 | `Game.season` | `season` | `` | `` | Yes |
| 23 | `wrinklers.amount` | `wrinkler_amount` | `0` | `0` | Yes |
| 24 | `wrinklers.number` | `wrinkler_number` | `0` | `0` | Yes |
| 25 | `Game.prestige` | `prestige` | `0` | `0` | Yes |
| 26 | `Game.heavenlyChips` | `heavenly_chips` | `0` | `0` | Yes |
| 27 | `Game.heavenlyChipsSpent` | `heavenly_chips_spent` | `0` | `0` | Yes |
| 28 | `Game.heavenlyCookies` | `heavenly_cookies` | `0` | `0` | Yes |
| 29 | `Game.ascensionMode` | `ascension_mode` | `0` | `0` | Yes |
| 30 | `Game.permanentUpgrades[0]` | `permanent_upgrades` | `-1` | `-1;-1;-1;-1;-1` | **No** |
| 31 | `Game.permanentUpgrades[1]` | `permanent_upgrades` | `-1` | *(part of above)* | **No** |
| 32 | `Game.permanentUpgrades[2]` | `permanent_upgrades` | `-1` | *(part of above)* | **No** |
| 33 | `Game.permanentUpgrades[3]` | `permanent_upgrades` | `-1` | *(part of above)* | **No** |
| 34 | `Game.permanentUpgrades[4]` | `permanent_upgrades` | `-1` | *(part of above)* | **No** |
| 35 | `Game.dragonLevel` | `dragon_level` | `0` | `0` | Yes |
| 36 | `Game.dragonAura` | `dragon_aura` | `0` | `0` | Yes |
| 37 | `Game.dragonAura2` | `dragon_aura2` | `0` | `0` | Yes |
| 38 | `Game.chimeType` | `chime_type` | `0` | `75` | **No** |
| 39 | `Game.volume` | `volume` | `75` | `0` | **No** |
| 40 | `wrinklers.shinies` | `shiny_wrinkler_amount` | `0` | `0` | Yes |
| 41 | `wrinklers.amountShinies` | `shiny_wrinkler_number` | `0` | `4` | **No** |
| 42 | `Game.lumps` | `lumps` | `4` | `5` | **No** |
| 43 | `Game.lumpsTotal` | `lumps_total` | `5` | `1753703678952` | **No** |
| 44 | `Game.lumpT` | `lump_t` | `1753703678952` | `0` | **No** |
| 45 | `Game.lumpRefill` | `lump_refill` | `0` | `0` | Yes |
| 46 | `Game.lumpCurrentType` | `lump_current_type` | `0` | `` | **No** |
| 47 | `Game.vault` | `vault` | `` | `41` | **No** |
| 48 | `Game.heralds` | `heralds` | `41` | `0` | **No** |
| 49 | `Game.fortuneGC` | `fortune_gc` | `0` | `0` | Yes |
| 50 | `Game.fortuneCPS` | `fortune_cps` | `0` | `793163.0812128433` | **No** |
| 51 | `Game.cookiesPsRawHighest` | `cookies_ps_raw_highest` | `793163.0812128433` | `50` | **No** |
| 52 | `Game.volumeMusic` | `volume_music` | `50` | `0` | **No** |
| 53 | `Game.cookiesSent` | `cookies_sent` | `0` | `0` | Yes |
| 54 | `Game.cookiesReceived` | `cookies_received` | `0` | `` | **No** |

## Conclusion

The investigation reveals two primary issues:

1.  **Incorrect Delimiter Handling:** The `permanent_upgrades` field is the most significant error. The original save file uses five separate semicolon-delimited fields for this data. The Python script incorrectly parses this as a single field and then attempts to serialize it back using a nested semicolon, which breaks the structure.

2.  **Off-by-One Errors and Type Mismatches:** There are numerous other mismatches in the latter half of the stats string. These are caused by the initial `permanent_upgrades` error, which shifts the index for all subsequent fields. This leads to values being parsed into the wrong keys in the `main_stats` dictionary and then being serialized in the wrong order. For example, `Game.volume` (75) is being incorrectly assigned to the `chime_type` key.

To fix this, the parsing logic in `parser.py` must be corrected to treat the five permanent upgrade slots as distinct fields, and the serialization logic in `main.py` must be updated to match.
